<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Sum-of-Squares Matrices · SumOfSquares</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">SumOfSquares</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Index</a></li><li><a class="tocitem" href="../../sumofsquares/">Sum-of-Squares Programming</a></li><li><a class="tocitem" href="../../variables/">Variables</a></li><li><a class="tocitem" href="../../constraints/">Constraints</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../Bound on Global Extremum/">Bound on Global Extremum</a></li><li><a class="tocitem" href="../Dihedral symmetry of the Robinson form/">Dihedral symmetry of the Robinson form</a></li><li><a class="tocitem" href="../Even reduction/">Even reduction</a></li><li><a class="tocitem" href="../Getting started/">Getting started</a></li><li><a class="tocitem" href="../Lyapunov Function Search/">Lyapunov Function Search</a></li><li><a class="tocitem" href="../Motzkin/">Motzkin</a></li><li><a class="tocitem" href="../Noncommutative variables/">Noncommutative variables</a></li><li><a class="tocitem" href="../Polynomial Optimization/">Polynomial Optimization</a></li><li><a class="tocitem" href="../SOS decomposition/">SOS decomposition</a></li><li><a class="tocitem" href="../Stabilization of nonlinear systems/">Stabilization of nonlinear systems</a></li><li class="is-active"><a class="tocitem" href>Sum-of-Squares Matrices</a></li><li><a class="tocitem" href="../Sums of Hermitian squares/">Sums of Hermitian squares</a></li><li><a class="tocitem" href="../Symmetry reduction/">Symmetry reduction</a></li><li><a class="tocitem" href="../Term sparsity/">Term sparsity</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Sum-of-Squares Matrices</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Sum-of-Squares Matrices</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jump-dev/SumOfSquares.jl/blob/master/examples/Sum-of-Squares Matrices.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Sum-of-Squares-matrices"><a class="docs-heading-anchor" href="#Sum-of-Squares-matrices">Sum-of-Squares matrices</a><a id="Sum-of-Squares-matrices-1"></a><a class="docs-heading-anchor-permalink" href="#Sum-of-Squares-matrices" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/jump-dev/SumOfSquares.jl/gh-pages?filepath=previews/PR187/generated/Sum-of-Squares Matrices.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/jump-dev/SumOfSquares.jl/blob/gh-pages/previews/PR187/generated/Sum-of-Squares Matrices.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <strong>Adapted from</strong>: Examples 3.77 of [BPT12]</p><p>[BPT12] Blekherman, G.; Parrilo, P. A. &amp; Thomas, R. R. <em>Semidefinite Optimization and Convex Algebraic Geometry</em>. Society for Industrial and Applied Mathematics, <strong>2012</strong>.</p><h3 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h3><p>Consider the symmetric polynomial matrix <span>$P(x) = \begin{bmatrix}     x^2 - 2x + 2 &amp; x\\
    x            &amp; x^2 \end{bmatrix}.$</span> We could like to know whether <span>$P(x)$</span> is positive semidefinite for all <span>$x \in \mathbb{R}$</span>.</p><pre><code class="language-julia">using DynamicPolynomials
@polyvar x
P = [x^2 - 2x + 2 x
            x     x^2]</code></pre><pre class="documenter-example-output">2×2 Array{DynamicPolynomials.Polynomial{true,Int64},2}:
 x² - 2x + 2  x
 x            x²</pre><p>A sufficient condition for a symmetric polynomial matrix <span>$P(x)$</span> to be positive semidefinite for all <span>$x$</span> is to the existence of a matrix <span>$M(x)$</span> such that <span>$P(x) = M^\top(x) M(x)$</span>. If such matrix <span>$M$</span> exists, we say that the matrix is an \emph{sos matrix} (see [Definition 3.76, BPT13]). While determining whether <span>$P(x)$</span> is positive semidefinite for all <span>$x$</span>, is NP-hard (checking nonnegativity of a polynomial is reduced to this problem for <span>$1 \times 1$</span> matrices), checking whether <span>$P(x)$</span> is an sos matrix is an sos program.</p><pre><code class="language-julia">using SumOfSquares</code></pre><p>We first need to pick an SDP solver, see <a href="http://jump.dev/JuMP.jl/dev/installation/#Getting-Solvers-1">here</a> for a list of the available choices.</p><pre><code class="language-julia">import CSDP
solver = optimizer_with_attributes(CSDP.Optimizer, MOI.Silent() =&gt; true)

model = SOSModel(solver)
mat_cref = @constraint(model, P in PSDCone())
optimize!(model)
termination_status(model) #!src</code></pre><pre class="documenter-example-output">OPTIMAL::TerminationStatusCode = 1</pre><p>While the reformulation of sos matrix to sos polynomial is rather simple, as explained in the &quot;Sum-of-Squares reformulation&quot; section below, there is a technical subtelty about the Newton polytope that if not handled correctly may result in an SDP of large size with bad numerical behavior. For this reason, it is recommended to model sos <em>matrix</em> constraints as such as will be shown in this notebook and not do the formulation manually unless there is a specific reason to do so.</p><p>As we can verify as follows, only 3 monomials are used using the sos <em>matrix</em> constraint.</p><pre><code class="language-julia">certificate_monomials(mat_cref)</code></pre><pre class="documenter-example-output">3-element DynamicPolynomials.MonomialVector{true}:
 x##768
 x##770
 ##768</pre><h3 id="Sum-of-Squares-reformulation"><a class="docs-heading-anchor" href="#Sum-of-Squares-reformulation">Sum-of-Squares reformulation</a><a id="Sum-of-Squares-reformulation-1"></a><a class="docs-heading-anchor-permalink" href="#Sum-of-Squares-reformulation" title="Permalink"></a></h3><p>One way to obtain the reduction to an sos program is to create an intermediate vector of variable <span>$y$</span> and check whether the polynomial <span>$p(x, y) = y^\top P(x) y$</span> is sos. However, special care is required when approximating the Newton polytope of <span>$p(x, y)$</span>. Indeed, for instance if the entries of <span>$P(x)$</span> are quadratic forms then the Newton polytope of <span>$p(x, y)$</span> is the cartesian product between the Newton polytope of <span>$y^\top y$</span> and the Newton polytope of <span>$x^\top x$</span>. In other words, <span>$p(x, y)$</span> belongs to a family of quartic forms called biquadratic forms. This fact is important when generating the semidefinite program so that only bilinear monomials are used. So if the cheap outer approximation is used (instead of the exact polyhedral computation) for the newton polytope then it is important to use a multipartite computation approximation of the newton polytope. The multipartie exact approach may perform worse compared to the unipartite exact in certain cases though. Consider for instance the polynomial matrix <span>$\mathrm{Diag}(x_1^1, x_2^2)$</span> for which <span>$p(x, y) = x_1^2y_1^2 + x_2^2y_2^2$</span>. For this polynomial, only the monomials <span>$x_1y_1$</span> and <span>$x_2y_2$</span> are needed in the SDP reformulation while the multipartite approach, as it will compute the Newton polytope as a cartesian product, will not see the dependence between <span>$x$</span> and <span>$y$</span> in the presence of monomials and will also select the monomials <span>$x_1y_2$</span> and <span>$x_2y_1$</span>.</p><pre><code class="language-julia">@polyvar y[1:2]
p = vec(y)&#39; * P * vec(y)</code></pre><p class="math-container">\[ x^{2}y_{1}^{2} + x^{2}y_{2}^{2} - 2xy_{1}^{2} + 2xy_{1}y_{2} + 2y_{1}^{2} \]</p><p>We can see above that <code>p</code> is biquadratic polynomial in the variables <code>x</code> and <code>y</code>. Computing the Newton polytope with the cheap outer approximation without exploiting this multipartite structure gives the following 6 monomials.</p><pre><code class="language-julia">X = monomials(p)
Certificate.monomials_half_newton_polytope(X, tuple(), apply_post_filter = false)</code></pre><pre class="documenter-example-output">6-element DynamicPolynomials.MonomialVector{true}:
 xy₁
 xy₂
 y₁y₂
 x
 y₁
 y₂</pre><p>Exploiting the multipartite structure gives 4 monomials.</p><pre><code class="language-julia">Certificate.monomials_half_newton_polytope(X, ([x], y), apply_post_filter = false)</code></pre><pre class="documenter-example-output">4-element DynamicPolynomials.MonomialVector{true}:
 xy₁
 xy₂
 y₁
 y₂</pre><p>In the example above, there were only 3 monomials, where does the difference come from ? Using the monomial basis, the only product of two monomials that is equal to <code>y[2]^2</code> is <code>y[2] * y[2]</code>. As <code>y[2]^2</code> is not a monomial of <code>p</code>, we can conclude that the diagonal entry with row and column corresponding to <code>y[2]</code> will be zero hence the whole column and row will be zero as well. Therefore, we can remove this monomial.</p><pre><code class="language-julia">Certificate.monomials_half_newton_polytope(X, ([x], y))</code></pre><pre class="documenter-example-output">3-element DynamicPolynomials.MonomialVector{true}:
 xy₁
 xy₂
 y₁</pre><p>The same reasoning can be used for monomials <code>y[1]y[2]</code> and <code>x</code> therefore whether we exploit the multipartite structure or not, we get only 3 monomials thanks to this post filter.</p><pre><code class="language-julia">Certificate.monomials_half_newton_polytope(X, tuple())</code></pre><pre class="documenter-example-output">3-element DynamicPolynomials.MonomialVector{true}:
 xy₁
 xy₂
 y₁</pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Stabilization of nonlinear systems/">« Stabilization of nonlinear systems</a><a class="docs-footer-nextpage" href="../Sums of Hermitian squares/">Sums of Hermitian squares »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 3 March 2021 11:26">Wednesday 3 March 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
