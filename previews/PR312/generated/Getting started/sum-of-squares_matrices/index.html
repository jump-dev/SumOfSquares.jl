<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Sum-of-Squares matrices · SumOfSquares</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">SumOfSquares</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Index</a></li><li><a class="tocitem" href="../../../sumofsquares/">Sum-of-Squares Programming</a></li><li><a class="tocitem" href="../../../variables/">Variables</a></li><li><a class="tocitem" href="../../../constraints/">Constraints</a></li><li><span class="tocitem">Tutorials</span><ul><li><input class="collapse-toggle" id="menuitem-5-1" type="checkbox" checked/><label class="tocitem" for="menuitem-5-1"><span class="docs-label">Getting started</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../circle/">Nonnegative over a variety</a></li><li><a class="tocitem" href="../getting_started/">Getting started</a></li><li><a class="tocitem" href="../motzkin/">Motzkin</a></li><li><a class="tocitem" href="../sos_decomposition/">A trivial SOS decomposition example</a></li><li class="is-active"><a class="tocitem" href>Sum-of-Squares matrices</a></li><li><a class="tocitem" href="../univariate/">Minimization of a univariate polynomial</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Polynomial Optimization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Polynomial Optimization/bound_on_global_extremum/">Bound on Global Extremum</a></li><li><a class="tocitem" href="../../Polynomial Optimization/extracting_minimizers/">Extracting minimizers</a></li><li><a class="tocitem" href="../../Polynomial Optimization/polynomial_optimization/">Polynomial Optimization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Systems and Control</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Systems and Control/barrier_certificate/">Barrier certificates for collision avoidance</a></li><li><a class="tocitem" href="../../Systems and Control/julia_set/">Outer approximation of Julia set</a></li><li><a class="tocitem" href="../../Systems and Control/lyapunov_function_search/">Lyapunov Function Search</a></li><li><a class="tocitem" href="../../Systems and Control/stabilization_of_nonlinear_systems/">Stabilization of nonlinear systems</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-4" type="checkbox"/><label class="tocitem" for="menuitem-5-4"><span class="docs-label">Other Applications</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Other Applications/bounds_in_probability/">Bounds in Probability</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-5" type="checkbox"/><label class="tocitem" for="menuitem-5-5"><span class="docs-label">Noncommutative and Hermitian</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Noncommutative and Hermitian/noncommutative_variables/">Noncommutative variables</a></li><li><a class="tocitem" href="../../Noncommutative and Hermitian/sums_of_hermitian_squares/">Sums of Hermitian squares</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-6" type="checkbox"/><label class="tocitem" for="menuitem-5-6"><span class="docs-label">Sparsity</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Sparsity/sign_symmetry/">Sign symmetry</a></li><li><a class="tocitem" href="../../Sparsity/term_sparsity/">Term sparsity</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-7" type="checkbox"/><label class="tocitem" for="menuitem-5-7"><span class="docs-label">Symmetry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Symmetry/cyclic/">Cyclic symmetry for Sums of Hermitian Squares</a></li><li><a class="tocitem" href="../../Symmetry/dihedral/">Dihedral symmetry of the Robinson form</a></li><li><a class="tocitem" href="../../Symmetry/even_reduction/">Even reduction</a></li><li><a class="tocitem" href="../../Symmetry/permutation_symmetry/">Symmetry reduction</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-8" type="checkbox"/><label class="tocitem" for="menuitem-5-8"><span class="docs-label">Extension</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Extension/certificate/">Certificate</a></li><li><a class="tocitem" href="../../Extension/hypercube/">Hypercube</a></li><li><a class="tocitem" href="../../Extension/typed/">Multivariate polynomials implementations</a></li><li><a class="tocitem" href="../../Extension/univariate_solver/">Univariate Solver</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li><a class="is-disabled">Getting started</a></li><li class="is-active"><a href>Sum-of-Squares matrices</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Sum-of-Squares matrices</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jump-dev/SumOfSquares.jl/blob/master/docs/src/tutorials/Getting started/sum-of-squares_matrices.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Sum-of-Squares-matrices"><a class="docs-heading-anchor" href="#Sum-of-Squares-matrices">Sum-of-Squares matrices</a><a id="Sum-of-Squares-matrices-1"></a><a class="docs-heading-anchor-permalink" href="#Sum-of-Squares-matrices" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/jump-dev/SumOfSquares.jl/gh-pages?filepath=previews/PR312/generated/Getting started/sum-of-squares_matrices.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/jump-dev/SumOfSquares.jl/blob/gh-pages/previews/PR312/generated/Getting started/sum-of-squares_matrices.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a> <strong>Adapted from</strong>: Examples 3.77 of [BPT12]</p><p>[BPT12] Blekherman, G.; Parrilo, P. A. &amp; Thomas, R. R. <em>Semidefinite Optimization and Convex Algebraic Geometry</em>. Society for Industrial and Applied Mathematics, <strong>2012</strong>.</p><h3 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h3><p>Consider the symmetric polynomial matrix <span>$P(x) = \begin{bmatrix}     x^2 - 2x + 2 &amp; x\\
    x            &amp; x^2 \end{bmatrix}.$</span> We could like to know whether <span>$P(x)$</span> is positive semidefinite for all <span>$x \in \mathbb{R}$</span>.</p><pre><code class="language-julia hljs">using DynamicPolynomials
@polyvar x
P = [x^2 - 2x + 2 x
            x     x^2]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×2 Matrix{DynamicPolynomials.Polynomial{DynamicPolynomials.Commutative{DynamicPolynomials.CreationOrder}, MultivariatePolynomials.Graded{MultivariatePolynomials.LexOrder}, Int64}}:
 2 - 2x + x²  x
 x            x²</code></pre><p>A sufficient condition for a symmetric polynomial matrix <span>$P(x)$</span> to be positive semidefinite for all <span>$x$</span> is to the existence of a matrix <span>$M(x)$</span> such that <span>$P(x) = M^\top(x) M(x)$</span>. If such matrix <span>$M$</span> exists, we say that the matrix is an \emph{sos matrix} (see [Definition 3.76, BPT13]). While determining whether <span>$P(x)$</span> is positive semidefinite for all <span>$x$</span>, is NP-hard (checking nonnegativity of a polynomial is reduced to this problem for <span>$1 \times 1$</span> matrices), checking whether <span>$P(x)$</span> is an sos matrix is an sos program.</p><pre><code class="language-julia hljs">using SumOfSquares</code></pre><p>We first need to pick an SDP solver, see <a href="https://jump.dev/JuMP.jl/v1.12/installation/#Supported-solvers">here</a> for a list of the available choices.</p><pre><code class="language-julia hljs">import CSDP
solver = optimizer_with_attributes(CSDP.Optimizer, MOI.Silent() =&gt; true)

model = SOSModel(solver)
mat_cref = @constraint(model, P in PSDCone())
optimize!(model)
termination_status(model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">OPTIMAL::TerminationStatusCode = 1</code></pre><p>While the reformulation of sos matrix to sos polynomial is rather simple, as explained in the &quot;Sum-of-Squares reformulation&quot; section below, there is a technical subtelty about the Newton polytope that if not handled correctly may result in an SDP of large size with bad numerical behavior. For this reason, it is recommended to model sos <em>matrix</em> constraints as such as will be shown in this notebook and not do the formulation manually unless there is a specific reason to do so.</p><p>As we can verify as follows, only 3 monomials are used using the sos <em>matrix</em> constraint.</p><pre><code class="language-julia hljs">certificate_monomials(mat_cref)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element DynamicPolynomials.MonomialVector{DynamicPolynomials.Commutative{DynamicPolynomials.CreationOrder}, MultivariatePolynomials.Graded{MultivariatePolynomials.LexOrder}}:
 ##24189
 x##24191
 x##24189</code></pre><h3 id="Sum-of-Squares-reformulation"><a class="docs-heading-anchor" href="#Sum-of-Squares-reformulation">Sum-of-Squares reformulation</a><a id="Sum-of-Squares-reformulation-1"></a><a class="docs-heading-anchor-permalink" href="#Sum-of-Squares-reformulation" title="Permalink"></a></h3><p>One way to obtain the reduction to an sos program is to create an intermediate vector of variable <span>$y$</span> and check whether the polynomial <span>$p(x, y) = y^\top P(x) y$</span> is sos. However, special care is required when approximating the Newton polytope of <span>$p(x, y)$</span>. Indeed, for instance if the entries of <span>$P(x)$</span> are quadratic forms then the Newton polytope of <span>$p(x, y)$</span> is the cartesian product between the Newton polytope of <span>$y^\top y$</span> and the Newton polytope of <span>$x^\top x$</span>. In other words, <span>$p(x, y)$</span> belongs to a family of quartic forms called biquadratic forms. This fact is important when generating the semidefinite program so that only bilinear monomials are used. So if the cheap outer approximation is used (instead of the exact polyhedral computation) for the newton polytope then it is important to use a multipartite computation approximation of the newton polytope. The multipartie exact approach may perform worse compared to the unipartite exact in certain cases though. Consider for instance the polynomial matrix <span>$\mathrm{Diag}(x_1^1, x_2^2)$</span> for which <span>$p(x, y) = x_1^2y_1^2 + x_2^2y_2^2$</span>. For this polynomial, only the monomials <span>$x_1y_1$</span> and <span>$x_2y_2$</span> are needed in the SDP reformulation while the multipartite approach, as it will compute the Newton polytope as a cartesian product, will not see the dependence between <span>$x$</span> and <span>$y$</span> in the presence of monomials and will also select the monomials <span>$x_1y_2$</span> and <span>$x_2y_1$</span>.</p><pre><code class="language-julia hljs">@polyvar y[1:2]
p = vec(y)&#39; * P * vec(y)</code></pre><p class="math-container">\[ 2y_{1}^{2} + 2xy_{1}y_{2} - 2xy_{1}^{2} + x^{2}y_{2}^{2} + x^{2}y_{1}^{2} \]</p><p>We can see above that <code>p</code> is biquadratic polynomial in the variables <code>x</code> and <code>y</code>. Computing the Newton polytope with the cheap outer approximation without exploiting this multipartite structure gives the following 6 monomials.</p><pre><code class="language-julia hljs">X = monomials(p)
unipartite = Certificate.NewtonDegreeBounds(tuple())
Certificate.monomials_half_newton_polytope(X, unipartite)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element DynamicPolynomials.MonomialVector{DynamicPolynomials.Commutative{DynamicPolynomials.CreationOrder}, MultivariatePolynomials.Graded{MultivariatePolynomials.LexOrder}}:
 y₂
 y₁
 x
 y₁y₂
 xy₂
 xy₁</code></pre><p>Exploiting the multipartite structure gives 4 monomials.</p><pre><code class="language-julia hljs">multipartite = Certificate.NewtonDegreeBounds(([x], y))
Certificate.monomials_half_newton_polytope(X, multipartite)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element DynamicPolynomials.MonomialVector{DynamicPolynomials.Commutative{DynamicPolynomials.CreationOrder}, MultivariatePolynomials.Graded{MultivariatePolynomials.LexOrder}}:
 y₂
 y₁
 xy₂
 xy₁</code></pre><p>In the example above, there were only 3 monomials, where does the difference come from ? Using the monomial basis, the only product of two monomials that is equal to <code>y[2]^2</code> is <code>y[2] * y[2]</code>. As <code>y[2]^2</code> is not a monomial of <code>p</code>, we can conclude that the diagonal entry with row and column corresponding to <code>y[2]</code> will be zero hence the whole column and row will be zero as well. Therefore, we can remove this monomial.</p><pre><code class="language-julia hljs">Certificate.monomials_half_newton_polytope(X, Certificate.NewtonFilter(multipartite))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element DynamicPolynomials.MonomialVector{DynamicPolynomials.Commutative{DynamicPolynomials.CreationOrder}, MultivariatePolynomials.Graded{MultivariatePolynomials.LexOrder}}:
 y₁
 xy₂
 xy₁</code></pre><p>The same reasoning can be used for monomials <code>y[1]y[2]</code> and <code>x</code> therefore whether we exploit the multipartite structure or not, we get only 3 monomials thanks to this post filter.</p><pre><code class="language-julia hljs">Certificate.monomials_half_newton_polytope(X, Certificate.NewtonFilter(unipartite))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element DynamicPolynomials.MonomialVector{DynamicPolynomials.Commutative{DynamicPolynomials.CreationOrder}, MultivariatePolynomials.Graded{MultivariatePolynomials.LexOrder}}:
 y₁
 xy₂
 xy₁</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../sos_decomposition/">« A trivial SOS decomposition example</a><a class="docs-footer-nextpage" href="../univariate/">Minimization of a univariate polynomial »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Friday 30 June 2023 07:20">Friday 30 June 2023</span>. Using Julia version 1.9.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
